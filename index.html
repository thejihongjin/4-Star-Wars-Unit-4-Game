<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Page Title</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" type="text/css" href="./assets/css/style.css">

    <style type="text/css">
        .fighter-img {
            width: 150px;
            height: 150px;
			margin-right: 5px;
        }
    </style>
</head>
<body>

    Star Wars RPG!<br>
    <!-- starting character list -->
    <div id="fighters"></div>
    Your Character<br>
    <div id="player"></div>
    Enemies Available to Attack<br>
    <div id="enemies-available"></div>
    Fight Section<br>
    <button class="attack">Attack</button><br>
    Defender<br>
    <div id="defender"></div>
    <div id="results-txt"></div>

<!-- 

-->

    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    <script type="text/javascript">
	var fightersArr = [
		{
			name: 'Obi-Wan Kenobi',
			health: 120,
			attack: 8,
			counter: 8,
			src: 'obi-wan-kenobi.jpg'
		},
		{
			name: 'Luke Skywalker',
			health: 100,
			attack: 5,
			counter: 5,
			src: 'luke_skywalker.jpg'
		},
		{
			name: 'Darth Sidious',
			health: 150,
			attack: 20,
			counter: 10,//20,
			src: 'darth-sidious.jpg'
		},
		{
			name: 'Darth Maul',
			health: 180,
			attack: 25,
			counter: 25,
			src: 'darth-maul.png'
		},
	]
	
	$("#player").empty();
	$("#enemies-available").empty();
	$("#defender").empty();
	$("#results-txt").empty();
	generateFighters();
	var playerName = '';
	var defenderName = '';
	var playerHealth = 0;
	var defenderHealth = 0;
	var playerBasePwr = 0;
	var playerAttack = 0;
	var defenderAttack = 0;

    console.log("playerHealth " + playerHealth);
    
        $("#fighters").on("click", ".fighter-img", function() {
			playerName = $(this).attr("name");
			playerHealth = parseInt($(this).attr("health-pts"));
			playerBasePwr = parseInt($(this).attr("attack-pwr"));
            $(this).detach().appendTo("#player");
            $(".fighter-img").not($(this)).detach().appendTo("#enemies-available");
			console.log("playerHealth " + playerHealth);
        });

        $("#enemies-available").on("click", ".fighter-img", function() {
			if ($("#defender").is(':empty')) {
				defenderName = $(this).attr("name");
				defenderHealth = parseInt($(this).attr("health-pts"));
				defenderAttack = parseInt($(this).attr("counter-pwr"));
				$(this).detach().appendTo("#defender");
				$("#results-txt").empty();
			}
        });

		$(".attack").on("click", function() {
			if (playerHealth > 0 && $("#defender").is(':empty') === false) {
				playerAttack += playerBasePwr;
				defenderHealth -= playerAttack;
				playerHealth -= defenderAttack;
				if (defenderHealth > 0) {
					$("#results-txt").text("You attacked " + defenderName + " for " + playerAttack + " damage. " + defenderName + " attacked you back for " + defenderAttack + " damage.") //add br with .html??
					//update playerHealth text and defenderHealth text
					console.log("playerHealth " + playerHealth + " defenderHealth " + defenderHealth);
				} else if (defenderHealth <= 0) {
					$("#defender").empty();
					if ($("#enemies-available").is(':empty') === false) {
						$("#results-txt").text("You have defeated " + defenderName + ", you can choose to fight another enemy");
					} else if ($("#enemies-available").is(':empty') === true) {
						$("#results-txt").text("You won!!!! GAME OVER!!!");
						$("#results-txt").append('<br><button class="reset">Restart</button>');
					}
				}
			} else if (playerHealth > 0 && $("#defender").is(':empty') === true) {
				$("#results-txt").text("No enemy here");
			} else if (playerHealth <= 0) {
				$("#results-txt").text("You have been defeated...GAME OVER!!!");
				$("#results-txt").append('<br><button class="reset">Restart</button>')
			}
			console.log("$('#enemies-available').is(':empty')" + $("#enemies-available").is(':empty'));
			console.log("$('#defender').is(':empty')" + $("#defender").is(':empty'));
		});

		$("#results-txt").on("click", ".reset", function() {
			playerName = '';
			defenderName = '';
			playerHealth = 0;
			defenderHealth = 0;
			playerBasePwr = 0;
			playerAttack = 0;
			defenderAttack = 0;
			$("#player").empty();
			$("#enemies-available").empty();
			$("#defender").empty();
			$("#results-txt").empty();
			generateFighters();
		});

	function generateFighters() {
		for (var i = 0; i < fightersArr.length; i++) {
			var imgFighter = $("<img>");
			imgFighter.addClass("fighter-img");
			imgFighter.attr("name", fightersArr[i].name);
			imgFighter.attr("src", "./assets/images/" + fightersArr[i].src);
			imgFighter.attr("health-pts", fightersArr[i].health);
			imgFighter.attr("attack-pwr", fightersArr[i].attack);
			imgFighter.attr("counter-pwr", fightersArr[i].counter);
			$("#fighters").append(imgFighter);
			//display name and current hp
		}
	}

	</script>
	
    <!-- <script src="./assets/javascript/game.js"></script> -->
</body>
</html>

